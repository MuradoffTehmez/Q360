{% extends 'core/base.html' %}
{% load i18n %}

{% block title %}{% trans "Fərdi İnkişaf Planı" %}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center">
    <h2>{% trans "Fərdi İnkişaf Planı" %}</h2>
    <a href="javascript:history.back()" class="btn btn-secondary">{% trans "Geri Qayıt" %}</a>
</div>
<hr>
<div class="card shadow-sm">
    <div class="card-header">
        <h5 class="mb-0">{% trans "Plan Məlumatları" %}</h5>
    </div>
    <div class="card-body">
        <p class="mb-1"><strong>{% trans "İşçi:" %}</strong> {{ plan.ishchi.get_full_name }}</p>
        <p class="mb-0"><strong>{% trans "Qiymətləndirmə Dövrü:" %}</strong> {{ plan.dovr.ad }}</p>
    </div>
</div>

<h4 class="mt-4">{% trans "Hədəflər" %}</h4>

{% for item in hedefler_with_choices %}
<div class="card mb-3">
    <div class="card-body">
        <div class="row align-items-center">
            <div class="col-md-8">
                <p class="card-text">{{ item.hedef_obj.tesvir|linebreaks }}</p>
                <small class="text-muted">{% trans "Son tarix:" %} {{ item.hedef_obj.son_tarix|date:"d-m-Y" }}</small>
            </div>
            <div class="col-md-4">
                <form method="post" class="d-flex align-items-center justify-content-end">
                    {% csrf_token %}
                    <input type="hidden" name="hedef_id" value="{{ item.hedef_obj.id }}">

                    <select name="status" class="form-select me-2" {% if not is_plan_owner %}disabled{% endif %}>
                        {% for choice in item.status_choices %}
                        <option value="{{ choice.key }}" {% if choice.is_selected %}selected{% endif %}>{{ choice.value
                            }}</option>
                        {% endfor %}
                    </select>

                    {% if is_plan_owner %}
                    <button type="submit" class="btn btn-sm btn-success">{% trans "Yenilə" %}</button>
                    {% endif %}
                </form>
            </div>
        </div>
    </div>
</div>
{% empty %}
<div class="alert alert-info">{% trans "Bu plan üçün heç bir hədəf təyin edilməyib." %}</div>
{% endfor %}

{% endblock %}